
# gatk-HC-GT-pipeline (MINIMAL)
#   + uuid
#   + accession
name: gatk-HC-pipeline
description: Pipeline to run gatk-HC to call variants
uuid: 1936f246-22e1-45dc-bb5c-9cfd55537fe9
accession: GAPFIXRDPDK1

category:
  - Variant Calling

input:
  input_vcf:
    argument_type: file.vcf

  reference:
    argument_type: file.fa
    files:
      - reference_genome@hg38
      - reference_bam@hg38

  samples:
    argument_type: parameter.json

  qc_ruleset_name_1:
    argument_type: parameter.qc_ruleset
    qc_thresholds:
      c1:
        rule: coverage|>=|100|80
        flag: True
      c2:
        rule: coverage|<=|200|180
      c3:
        rule: coverage|>|80|3.3
      rl:
        rule: read_length|==|PASS|NOT PASS
        flag: True
    qc_rule: ( {c1} and {c2} ) or not ( {c3} and {rl} )

workflows:
  ##########################################
  # gatk-HC
  ##########################################
  gatk-HC:
    # gatk-HC input
    input:
      vcf:
        argument_type: file.vcf
        source_argument_name: input_vcf

      reference:
        argument_type: file.fa

      samples:
        argument_type: parameter.json

      qc_ruleset:
        argument_type: parameter.qc_ruleset
        source_argument_name: qc_ruleset_name_1
    # gatk-HC output
    output:
      HC_vcf:
        file_type: hc-vcf
    # gatk-HC config
    config:
      ebs_size: 2x
      ec2_type: m.5xlarge
